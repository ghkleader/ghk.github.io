(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5fb7920e"],{"5e3e":function(e,t,a){"use strict";a("d364")},7004:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"search-eqp-info-main-container"},[a("div",{staticClass:"head_container"},[a("el-row",[a("el-col",[a("div",{staticClass:"search-container filter-item"},[a("label",[e._v("设备名称")]),a("el-select",{staticStyle:{width:"400px"},attrs:{filterable:"",multiple:"","collapse-tags":"",placeholder:"请选择设备名称"},model:{value:e.search.selectedEqpName,callback:function(t){e.$set(e.search,"selectedEqpName",t)},expression:"search.selectedEqpName"}},e._l(e.equipmentList,(function(e){return a("el-option",{key:e.Id,attrs:{label:e.EqpName+"("+e.Workline+")",value:e.EqpName}})})),1),a("br"),a("label",[e._v("统计周期")]),a("el-select",{attrs:{placeholder:"请选择统计周期"},on:{change:e.setPeriodMode},model:{value:e.search.periodMode,callback:function(t){e.$set(e.search,"periodMode",t)},expression:"search.periodMode"}},e._l(e.periodModeArray,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1),a("label",[e._v("报警ID")]),a("el-autocomplete",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{"fetch-suggestions":e.queryAlarmId,placeholder:"请输入报警ID值",clearable:""},on:{select:e.handleSelect},model:{value:e.search.alarmId,callback:function(t){e.$set(e.search,"alarmId",t)},expression:"search.alarmId"}}),a("br"),a("label",[e._v("开始时间")]),a("el-date-picker",{attrs:{type:e.DateType,clearable:!1,placeholder:"选择日期时间",align:"right","picker-options":e.startPickerOptions},model:{value:e.search.startTime,callback:function(t){e.$set(e.search,"startTime",t)},expression:"search.startTime"}}),a("label",{staticStyle:{"margin-left":"10px"}},[e._v("结束时间")]),a("el-date-picker",{attrs:{type:e.DateType,clearable:!1,placeholder:"选择日期时间",align:"right","picker-options":e.endPickerOptions},model:{value:e.search.endTime,callback:function(t){e.$set(e.search,"endTime",t)},expression:"search.endTime"}}),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleDraw}},[e._v(" 绘制 ")])],1)])],1)],1),a("div",{staticClass:"show-container"},[a("el-row",[a("el-col",{staticStyle:{"background-color":"#fff"}},[a("div",["everyHour"==e.search.periodMode?a("Sum-LineChart",{attrs:{data:e.alarmBarSrcData,config:e.alarmBarConfig}}):e._e(),"everyDay"==e.search.periodMode?a("Sum-LineChart",{attrs:{data:e.alarmBarSrcData,config:e.alarmBarConfig}}):e._e(),"everyMonth"==e.search.periodMode?a("Sum-LineChart",{attrs:{data:e.alarmBarSrcData,config:e.alarmBarConfig}}):e._e()],1)])],1)],1),a("div",{staticClass:"show-container"},[a("el-row",[a("el-col",{staticClass:"pie-container",attrs:{xs:24,sm:20,md:20,lg:16,xl:16}},[a("Eqp-Group-PieChart",{attrs:{data:e.pieSrcData,config:e.pieConfig}})],1),a("el-col",{staticClass:"log-container",attrs:{xs:0,sm:4,md:4,lg:8,xl:8}},[a("label",{staticStyle:{textAlign:"center",display:"block",fontSize:"22px",lineHeight:"50px",fontFamily:"'Arial'","font-weight":"normal"}},[e._v("报警信息")]),a("el-table",{attrs:{height:"500",data:e.alarmMesg,"row-class-name":e.setRowClass}},[a("el-table-column",{key:"1",attrs:{label:"时间",prop:"datetime","min-width":"30%",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.DateTime))])]}}])}),a("el-table-column",{key:"2",attrs:{label:"设备名称",prop:"eqpName","min-width":"25%",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.EqpName))])]}}])}),a("el-table-column",{key:"3",attrs:{label:"报警号",prop:"id","min-width":"15%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.Id))])]}}])}),a("el-table-column",{key:"4",attrs:{label:"信息",prop:"message","min-width":"50%",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.Message))])]}}])})],1)],1)],1)],1)])},r=[],n=a("5530"),o=(a("4de4"),a("d3b7"),a("159b"),a("14d9"),a("ac1f"),a("841c"),a("d81d"),a("b0c0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:e.className,style:{height:e.height,width:e.width}})}),l=[],s=(a("a15b"),a("b680"),a("313e")),c=a("ed08"),d={data:function(){return{$_sidebarElm:null,$_resizeHandler:null}},mounted:function(){var e=this;this.$_resizeHandler=Object(c["b"])((function(){e.chart&&e.chart.resize()}),100),this.$_initResizeEvent(),this.$_initSidebarResizeEvent()},beforeDestroy:function(){this.$_destroyResizeEvent(),this.$_destroySidebarResizeEvent()},activated:function(){this.$_initResizeEvent(),this.$_initSidebarResizeEvent()},deactivated:function(){this.$_destroyResizeEvent(),this.$_destroySidebarResizeEvent()},methods:{$_initResizeEvent:function(){window.addEventListener("resize",this.$_resizeHandler)},$_destroyResizeEvent:function(){window.removeEventListener("resize",this.$_resizeHandler)},$_sidebarResizeHandler:function(e){"width"===e.propertyName&&this.$_resizeHandler()},$_initSidebarResizeEvent:function(){this.$_sidebarElm=document.getElementsByClassName("sidebar-container")[0],this.$_sidebarElm&&this.$_sidebarElm.addEventListener("transitionend",this.$_sidebarResizeHandler)},$_destroySidebarResizeEvent:function(){this.$_sidebarElm&&this.$_sidebarElm.removeEventListener("transitionend",this.$_sidebarResizeHandler)}}};a("817d");var u={mixins:[d],props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"600px"},data:{type:Array,default:function(){return[{value:320,name:"PRINTER_1_L",message:"NO.1:buffe下压报警！"},{value:240,name:"PRINTER_2_L",message:"NO.1:buffe下压报警！"},{value:149,name:"PRINTER_3_L",message:"NO.1:buffe下压报警！"},{value:100,name:"PRINTER_4_L",message:"NO.1:buffe下压报警！"}]}},config:{type:Object,default:function(){return{title:"饼形图",graphicPos:370}}}},data:function(){return{chart:null}},watch:{data:{handler:function(e){this.chartSetOption()},deep:!0}},mounted:function(){var e=this;this.$nextTick((function(){e.initChart()}))},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart:function(){this.chart=s["init"](this.$el,"macarons"),this.chartSetOption()},chartSetOption:function(){var e=this;this.chart.setOption({title:{text:this.config.title,x:"center",top:10,textStyle:{fontWeight:"normal",color:"black",fontSize:"22",fontFamily:"Arial"}},graphic:{type:"text",left:"60%",top:this.config.graphicPos,style:{text:"{normal|--报警详细信息--}\n"+this.data.map((function(e){return e.message})).join("\n"),textAlign:"left",fill:"#333",fontSize:14,lineHeight:20,rich:{normal:{fontSize:16,fontWeight:700}}}},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},restore:{show:!1},saveAsImage:{show:!0}}},legend:{orient:"vertical",left:"60%",top:90,bottom:20,textStyle:{fontSize:16,lineHeight:18,fontFamily:"Arial",align:"center",rich:{normal:{fontSize:16,width:120},red:{fontSize:16,align:"center",color:"#EF3E5A",width:30},green:{fontSize:16,align:"center",color:"#00EE00",width:70}}},formatter:function(t){for(var a=e.data,i=0,r=0,n=0,o=0,l=a.length;o<l;o++)i+=a[o].value,a[o].name===t&&(r=a[o].value);return n=0===i?0:(r/i*100).toFixed(2),"{normal|"+t+"}共[{red|"+r+"}]次{green|"+n+"%}"}},series:[{name:"报警信息",type:"pie",roseType:"area",radius:[50,150],center:["30%","50%"],data:this.data,animationEasing:"cubicInOut",animationDuration:2600,itemStyle:{borderRadius:9}}]})}}},h=u,m=a("2877"),p=Object(m["a"])(h,o,l,!1,null,null,null),f=p.exports,g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:e.className,style:{height:e.height,width:e.width}})},b=[];a("817d"),a("9fad");var y=2e3,v={mixins:[d],props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"500px"},data:{type:Object,default:function(){return{eqpName:["测试"],xData:[1,2,3,4,5,6,7],yData:[2080,2032,4e3,3314,3690,6040,4820],ySumData:[2,3.3,4.5,23,16.5,12,6.2]}}},config:{type:Object,default:function(){return{title:"每日报警",dataClass:"everyDay",legendData:["报警个数","平均值","累计值"],valueLabelIsShow:!0}}}},data:function(){return{seriesData:[],chart:null}},watch:{data:{handler:function(e){this.chartSetOption()},deep:!0}},mounted:function(){var e=this;this.$nextTick((function(){e.initChart()}))},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart:function(){this.chart=s["init"](this.$el,"macarons"),this.chartSetOption()},chartSetOption:function(){if(0===this.data.xData.length)this.showNoDataOption();else{this.seriesData=[];for(var e=0;e<this.data.yData.length;e++){var t={name:this.data.eqpName[e],type:"line",data:this.data.yData[e]};this.seriesData.push(t)}this.setTwoDimHourDayMonthOption()}},showNoDataOption:function(){this.chart.clear(),this.chart.setOption({title:{text:this.config.title,left:"center",top:10,textStyle:{fontWeight:"normal",color:"black",fontSize:"22",fontFamily:"Arial"}},graphic:{type:"text",left:"center",top:"50%",style:{text:"暂无数据",fontSize:"22",fontFamily:"Arial",fill:"#909399"}},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{top:"10%",itemWidth:44,itemHeight:22,textStyle:{fontSize:15}},toolbox:{show:!0,feature:{dataZoom:{yAxisIndex:"none"},dataView:{show:!0,readOnly:!0,optionToContent:function(e){for(var t=e.xAxis[0].data,a=e.series,i='<table  border="1px" bordercolor="#e0dddd" cellspacing="0" style="width:100%;text-align:center"><tbody><tr><th style="padding:10px">时间</th><th>'+a[0].name+"</th><th>"+a[1].name+"</th></tr>",r=0,n=t.length;r<n;r++)i+="<tr><td>"+t[r]+"</td><td>"+a[0].data[r]+"</td><td>"+a[1].data[r]+"</td></tr>";return i+="</tbody></table>",i}},restore:{show:!0},saveAsImage:{show:!0}}},grid:{top:80,left:"2%",right:"2%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:this.data.xData,axisTick:{alignWithLabel:!0}}],yAxis:[{type:"value",axisTick:{show:!1}},{type:"value",position:"right",alignTicks:!0,axisLine:{show:!1,lineStyle:{color:"red"}}}],series:[{name:this.config.legendData[0],type:"bar",stack:"vistors",barWidth:"60%",label:{show:this.config.valueLabelIsShow,position:"inside",color:"white",fontSize:12},animationDuration:y},{name:this.config.legendData[1],type:"line",yAxisIndex:1,animationDuration:y},{name:this.config.legendData[2],type:"line",yAxisIndex:1,animationDuration:y}]},!0)},setTwoDimHourDayMonthOption:function(){this.chart.clear(),this.chart.setOption({title:{text:this.config.title,x:"center",top:10,textStyle:{fontWeight:"normal",color:"black",fontSize:"22",fontFamily:"Arial"}},tooltip:{trigger:"axis",axisPointer:{type:"line"},formatter:function(e){for(var t=e[0].name+"<br/>",a=0;a<e.length;a++)void 0!==e[a].data&&("平均值"===e[a].axisValue?t+=e[a].marker+e[a].seriesName+":&nbsp&nbsp&nbsp"+e[a].data.toFixed(2)+"个<br/>":t+=e[a].marker+e[a].seriesName+":&nbsp&nbsp&nbsp"+e[a].data+"个<br/>");return t}},legend:{top:"10%",itemWidth:44,itemHeight:22,textStyle:{fontSize:15}},grid:{top:80,left:"2%",right:"2%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:this.data.xData,axisTick:{alignWithLabel:!0}}],yAxis:[{type:"value",axisTick:{show:!1},axisLabel:{formatter:function(e,t){return e+"个"}}}],series:this.seriesData},!0)}}},D=v,x=Object(m["a"])(D,g,b,!1,null,null,null),S=x.exports,w=a("7cb6"),_=a("bfea"),C={name:"AlarmInfo",components:{EqpGroupPieChart:f,SumLineChart:S},data:function(){return{alarmBarConfig:null,alarmIdContainer:[],alarmMesg:[],barConfig:null,alarmBarConfigArray:{everyHour:{title:"每小时报警个数统计",dataClass:"everyHour",legendData:["小时报警个数","平均值","累计值"],valueLabelIsShow:!0},everyDay:{title:"每日报警个数统计",dataClass:"everyDay",legendData:["每日报警个数","平均值","累计值"],valueLabelIsShow:!0},everyMonth:{title:"每月报警个数统计",dataClass:"everyMonth",legendData:["每月报警个数","平均值","累计值"],valueLabelIsShow:!0}},pieConfig:{title:"报警统计",graphicPos:""},alarmBarSrcData:{eqpName:[],xData:[],yData:[],yAverageData:[],ySumData:[]},pieSrcData:[{name:"报警号-无",value:0,message:""}],search:{alarmId:void 0,periodMode:"everyHour",selectedEqpName:[],startTime:new Date((new Date).toLocaleDateString()+" 00:00:00"),endTime:new Date((new Date).toLocaleDateString()+" 24:00:00")},periodModeArray:[{label:"每小时",value:"everyHour"},{label:"每日",value:"everyDay"},{label:"每月",value:"everyMonth"}],equipmentList:null,DateType:"datetime",DateTypeArray:{everyHour:"datetime",everyDay:"date",everyMonth:"month"},equipStatusMode:{run:1,alarm:2,standby:3,stop:4},equipStatus:1,startPickerOptions:{shortcuts:[{text:"昨天",onClick:function(e){var t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}},{text:"一周前",onClick:function(e){var t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}},{text:"一个月前",onClick:function(e){var t=new Date;t.setTime(t.getTime()-2592e6),e.$emit("pick",t)}},{text:"六个月前",onClick:function(e){var t=new Date;t.setTime(t.getTime()-15552e6),e.$emit("pick",t)}}]},endPickerOptions:{shortcuts:[{text:"今天",onClick:function(e){var t=new Date;t.setTime(t.getTime()),e.$emit("pick",t)}}]}}},created:function(){this.alarmBarConfig=this.alarmBarConfigArray["everyHour"],null==this.equipmentList&&this.getTotalList(),this.pieConfig.graphicPos=130},mounted:function(){},beforeDestroy:function(){},methods:{queryAlarmId:function(e,t){var a=this.alarmIdContainer,i=e?a.filter(this.createFilter(e)):a;t(i)},createFilter:function(e){return function(t){return 0===t.value.toLowerCase().indexOf(e.toLowerCase())}},handleSelect:function(e){},getAllAlarmId:function(){var e=this,t={selectedEqpName:null};t.startTime=new Date((new Date).getTime()-31536e6),t.endTime=new Date,Object(_["d"])(t).then((function(t){var a=t.data;e.alarmIdContainer=[],a.forEach((function(t,a){e.alarmIdContainer.push({value:t})})),0!==e.alarmIdContainer.length&&(t.maxAlarmId?e.search.alarmId=t.maxAlarmId:e.search.alarmId=e.alarmIdContainer[0].value,e.handleDraw())}))},showAlarmMesg:function(){var e=this;if(this.search.alarmId){var t=Object(n["a"])({},this.search);delete t.periodMode,delete t.selectedEqpName,Object(_["a"])(t).then((function(t){var a=t.data;e.alarmMesg=a.map((function(t){return{DateTime:e.$sd.format(new Date(t.DateTime),"YYYY-MM-DD HH:mm"),EqpName:t.EqpName,Id:t.Id,Message:t.Message}}))}))}},setPeriodMode:function(){this.DateType=this.DateTypeArray[this.search.periodMode],this.alarmBarConfig=this.alarmBarConfigArray[this.search.periodMode]},getTotalList:function(){var e=this;Object(w["c"])().then((function(t){e.equipmentList=t.data.items;var a=[];a.push(e.equipmentList[0].EqpName),e.search.selectedEqpName=a,e.getAllAlarmId()}))},handleDraw:function(){var e=this;if(0!==this.search.selectedEqpName.length)if(null!=this.search.startTime&&null!=this.search.endTime)if(this.search.startTime>this.search.endTime)this.$notify.error({title:"错误",message:"时间设置错误! 开始时间不能大于结束时间"});else{Object(_["e"])(this.search).then((function(t){if(e.alarmBarSrcData=t.data,0!==t.data.xData.length){e.alarmBarSrcData.xData.push("平均值"),e.alarmBarSrcData.xData.push("累计值");for(var a=0;a<e.alarmBarSrcData.yData.length;a++)e.alarmBarSrcData.yData[a].push(e.alarmBarSrcData.yAverageData[a]),e.alarmBarSrcData.yData[a].push(e.alarmBarSrcData.ySumData[a])}}));var t=Object(n["a"])({},this.search);delete t.periodMode,Object(_["b"])(t).then((function(t){var a=t.data;e.pieSrcData=a.map((function(e){var t=e.message;return""!==t&&-1===t.indexOf("NO.")&&(t="NO."+e.id+":"+e.message),{name:e.name,value:e.value,message:t}})),e.pieConfig.graphicPos=30*t.data.length+90+10})),this.showAlarmMesg()}else this.$notify.error({title:"错误",message:"开始时间和结束时间为空！"});else this.$notify.error({title:"错误",message:"未获取到设备名称，网络故障! 请重新刷新页面！"})},setRowClass:function(e){var t=e.row,a=e.rowIndex;if(0===a&&null!=t)return"row-red"}}},k=C,O=(a("5e3e"),Object(m["a"])(k,i,r,!1,null,"6852b1f4",null));t["default"]=O.exports},"7cb6":function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"b",(function(){return s}));var i=a("b4af");function r(e){return Object(i["a"])({url:"/api/v1/equipments/page",method:"get",params:e})}function n(){return Object(i["a"])({url:"/api/v1/equipments",method:"get"})}function o(e){return Object(i["a"])({url:"/api/v1/equipments",method:"post",data:e})}function l(e){return Object(i["a"])({url:"/api/v1/equipments/"+e.Id,method:"put",data:e})}function s(e){return Object(i["a"])({url:"/api/v1/equipments/"+e.Id,method:"Delete",data:e})}},"9fad":function(e,t,a){var i,r,n;(function(o,l){r=[t,a("313e")],i=l,n="function"===typeof i?i.apply(t,r):i,void 0===n||(e.exports=n)})(0,(function(e,t){var a=function(e){"undefined"!==typeof console&&console&&console.error&&console.error(e)};if(t){var i=["#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487"],r={color:i,title:{textStyle:{fontWeight:"normal"}},visualMap:{color:["#1790cf","#a2d4e6"]},toolbox:{iconStyle:{borderColor:"#06467c"}},tooltip:{backgroundColor:"rgba(0,0,0,0.6)"},dataZoom:{dataBackgroundColor:"#dedede",fillerColor:"rgba(154,217,247,0.2)",handleColor:"#005eaa"},timeline:{lineStyle:{color:"#005eaa"},controlStyle:{color:"#005eaa",borderColor:"#005eaa"}},candlestick:{itemStyle:{color:"#c12e34",color0:"#2b821d"},lineStyle:{width:1,color:"#c12e34",color0:"#2b821d"},areaStyle:{color:"#e6b600",color0:"#005eaa"}},graph:{itemStyle:{color:"#e6b600"},linkStyle:{color:"#005eaa"}},map:{itemStyle:{color:"#f2385a",borderColor:"#eee",areaColor:"#ddd"},areaStyle:{color:"#ddd"},label:{color:"#c12e34"}},gauge:{axisLine:{show:!0,lineStyle:{color:[[.2,"#2b821d"],[.8,"#005eaa"],[1,"#c12e34"]],width:5}},axisTick:{splitNumber:10,length:8,lineStyle:{color:"auto"}},axisLabel:{color:"auto"},splitLine:{length:12,lineStyle:{color:"auto"}},pointer:{length:"90%",width:3,color:"auto"},title:{color:"#333"},detail:{color:"auto"}}};t.registerTheme("shine",r)}else a("ECharts is not Loaded")}))},bfea:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return n})),a.d(t,"d",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"b",(function(){return s})),a.d(t,"j",(function(){return c})),a.d(t,"f",(function(){return d})),a.d(t,"g",(function(){return u})),a.d(t,"h",(function(){return h})),a.d(t,"i",(function(){return m}));var i=a("b4af");function r(e){return Object(i["a"])({url:"/api/v1/equipments/alarms/groups",method:"get",params:e})}function n(e){return Object(i["a"])({url:"/api/v1/equipments/alarms",method:"get",params:e})}function o(e){return Object(i["a"])({url:"/api/v1/equipments/alarms/Ids",method:"get",params:e})}function l(e){return Object(i["a"])({url:"/api/v1/equipments/alarms/sum",method:"get",params:e})}function s(e){return Object(i["a"])({url:"/api/v1/equipments/alarms/eqp-groups",method:"get",params:e})}function c(e){return Object(i["a"])({url:"/api/v1/equipments/alarms/today/num",method:"get",params:e})}function d(){return Object(i["a"])({url:"/api/v1/equipments/alarms/72hours-total",method:"get"})}function u(){return Object(i["a"])({url:"/api/v1/equipments/alarms/72hours-broken-rate",method:"get"})}function h(){return Object(i["a"])({url:"/api/v1/equipments/alarms/72hours-pass-rate",method:"get"})}function m(){return Object(i["a"])({url:"/api/v1/equipments/alarms/latest",method:"get"})}},d364:function(e,t,a){}}]);