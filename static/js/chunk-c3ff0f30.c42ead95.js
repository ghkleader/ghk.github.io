(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c3ff0f30"],{"09e4":function(e,t,a){"use strict";a("2777")},2777:function(e,t,a){},"71dc":function(e,t,a){"use strict";a.d(t,"j",(function(){return l})),a.d(t,"h",(function(){return d})),a.d(t,"n",(function(){return p})),a.d(t,"o",(function(){return m})),a.d(t,"b",(function(){return h})),a.d(t,"i",(function(){return f})),a.d(t,"p",(function(){return g})),a.d(t,"c",(function(){return b})),a.d(t,"a",(function(){return v})),a.d(t,"d",(function(){return y})),a.d(t,"m",(function(){return S})),a.d(t,"e",(function(){return _})),a.d(t,"k",(function(){return k})),a.d(t,"l",(function(){return q})),a.d(t,"f",(function(){return x})),a.d(t,"g",(function(){return w}));a("d3b7"),a("d9e2");var n=a("bc3a"),r=a.n(n),i=a("5c96"),s=a("4360"),o=a("5f87"),u=r.a.create({baseURL:"/inter",timeout:3e5});u.interceptors.request.use((function(e){return s["a"].getters.token&&Object(o["a"])()&&(e.headers["Authorization"]="Bearer "+Object(o["a"])()),e}),(function(e){return console.log(e),Promise.reject(e)})),u.interceptors.response.use((function(e){var t=e.data;return 2e4!==t.code?(Object(i["Message"])({message:t.message||"Error",type:"error",duration:5e3}),50008!==t.code&&50012!==t.code&&50014!==t.code||i["MessageBox"].confirm("You have been logged out, you can cancel to stay on this page, or log in again","Confirm logout",{confirmButtonText:"Re-Login",cancelButtonText:"Cancel",type:"warning"}).then((function(){s["a"].dispatch("user/resetToken").then((function(){location.reload()}))})),Promise.reject(new Error(t.message||"Error"))):t}),(function(e){return console.log("err"+e),Object(i["Message"])({message:e.message,type:"error",duration:5e3}),Promise.reject(e)}));var c=u;function l(){return c({url:"api/v1/equipments/status",method:"get"})}function d(){return c({url:"api/v1/database/status",method:"get"})}function p(){return c({url:"api/v1/database/status/settings",method:"get"})}function m(e){return c({url:"api/v1/database/status/settings/name",method:"get",params:e})}function h(e){return c({url:"api/v1/database/status/settings/name",method:"put",data:e})}function f(){return c({url:"api/v1/database/status/tables",method:"get"})}function g(){return c({url:"api/v1/database/status/tables/flush",method:"get"})}function b(e){return c({url:"api/v1/database/status/settings/timer",method:"put",data:e})}function v(e){return c({url:"api/v1/database/status/settings/paras",method:"put",data:e})}function y(e){return c({url:"api/v1/database/status/tables",method:"delete",params:e})}function S(e){return c({url:"api/v1/ip/status",method:"get",params:e})}function _(e){return c({url:"api/v1/equipments/status/activation",method:"get",params:e})}function k(e){return c({url:"api/v1/equipments/status/maintenance/hours",method:"get",params:e})}function q(e){return c({url:"api/v1/equipments/status/maintenance/list",method:"get",params:e})}function x(){return c({url:"/api/v1/equipments/status/72hours-energy",method:"get"})}function w(){return c({url:"/api/v1/equipments/status/72hours-qr-pass-rate",method:"get"})}},"7c36":function(e,t,a){},"7cb6":function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return s})),a.d(t,"e",(function(){return o})),a.d(t,"b",(function(){return u}));var n=a("b4af");function r(e){return Object(n["a"])({url:"/api/v1/equipments/page",method:"get",params:e})}function i(){return Object(n["a"])({url:"/api/v1/equipments",method:"get"})}function s(e){return Object(n["a"])({url:"/api/v1/equipments",method:"post",data:e})}function o(e){return Object(n["a"])({url:"/api/v1/equipments/"+e.Id,method:"put",data:e})}function u(e){return Object(n["a"])({url:"/api/v1/equipments/"+e.Id,method:"Delete",data:e})}},be1f:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"search-eqp-info-main-container"},[a("div",{staticClass:"head_container"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{xs:24,sm:20,md:20,lg:18,xl:18}},[a("div",{staticClass:"search-container filter-item"},[a("label",[e._v("设备名称")]),a("el-select",{staticStyle:{width:"400px"},attrs:{filterable:"",placeholder:"请选择设备名称"},model:{value:e.search.selectedEqpName,callback:function(t){e.$set(e.search,"selectedEqpName",t)},expression:"search.selectedEqpName"}},e._l(e.equipmentList,(function(e){return a("el-option",{key:e.Id,attrs:{label:e.EqpName+"("+e.Workline+")",value:e.EqpName}})})),1),a("br"),a("label",[e._v("开始时间")]),a("el-date-picker",{attrs:{type:e.DateType,clearable:!1,placeholder:"选择日期时间",align:"right","picker-options":e.startPickerOptions},model:{value:e.search.startTime,callback:function(t){e.$set(e.search,"startTime",t)},expression:"search.startTime"}}),a("label",{staticStyle:{"margin-left":"10px"}},[e._v("结束时间")]),a("el-date-picker",{attrs:{type:e.DateType,clearable:!1,placeholder:"选择日期时间",align:"right","picker-options":e.endPickerOptions},model:{value:e.search.endTime,callback:function(t){e.$set(e.search,"endTime",t)},expression:"search.endTime"}}),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleDraw}},[e._v(" 绘制 ")])],1)]),a("el-col",{attrs:{xs:0,sm:4,md:4,lg:6,xl:6}},[a("div",{staticClass:"eqpstatus-container"},[a("h3",{},[e._v("设备状态")]),e.equipStatus==e.equipStatusMode.stop?a("div",{staticStyle:{width:"70px",border:"3px solid darkgrey",padding:"15px",background:"gray"}},[e._v("停机")]):e.equipStatus==e.equipStatusMode.alarm?a("div",{staticStyle:{width:"70px",border:"3px solid darkgrey",padding:"15px",background:"red"}},[e._v("报警")]):e.equipStatus==e.equipStatusMode.standby?a("div",{staticStyle:{width:"70px",border:"3px solid darkgrey",padding:"15px",background:"yellow"}},[e._v("待机")]):e.equipStatus==e.equipStatusMode.run?a("div",{staticStyle:{width:"70px",border:"3px solid darkgrey",padding:"15px",background:"limegreen"}},[e._v("运行")]):a("div",{staticStyle:{width:"70px",border:"3px solid darkgrey",padding:"15px",background:"limegreen"}},[e._v("--")]),a("div",{staticStyle:{border:"2px solid darkgrey"}},[a("span",{staticStyle:{float:"right",border:"3px solid darkgrey",padding:"5px",background:"gray"}},[e._v("停机")]),a("span",{staticStyle:{float:"right",border:"3px solid darkgrey",padding:"5px",background:"red"}},[e._v("报警")]),a("span",{staticStyle:{float:"right",border:"3px solid darkgrey",padding:"5px",background:"yellow"}},[e._v("待机")]),a("span",{staticStyle:{float:"right",border:"3px solid darkgrey",padding:"5px",background:"limegreen"}},[e._v("运行")])]),a("br")])])],1)],1),a("div",{staticClass:"show-container"},[a("el-row",[a("el-col",{staticClass:"pie-container",attrs:{xs:24,sm:20,md:20,lg:16,xl:16}},[a("AlarmPieChart",{attrs:{data:e.pieSrcData,config:e.pieConfig}})],1),a("el-col",{staticClass:"log-container",attrs:{xs:0,sm:4,md:4,lg:8,xl:8}},[a("label",{staticStyle:{textAlign:"center",display:"block",fontSize:"22px",lineHeight:"50px",fontFamily:"'Arial'","font-weight":"normal"}},[e._v("报警信息")]),a("el-table",{attrs:{height:"500",data:e.AlarmList,"row-class-name":e.setRowClass}},[a("el-table-column",{key:"1",attrs:{label:"时间",prop:"datetime","min-width":"15%",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.DateTime))])]}}])}),a("el-table-column",{key:"2",attrs:{label:"报警号",prop:"id","min-width":"10%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.Id))])]}}])}),a("el-table-column",{key:"3",attrs:{label:"持续时间",prop:"duration","min-width":"15%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.Duration)+"s")])]}}])}),a("el-table-column",{key:"4",attrs:{label:"信息",prop:"message","min-width":"50%",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.Message))])]}}])})],1)],1)],1)],1),a("div",{staticClass:"show-container"},[a("el-row",[a("el-col",{staticStyle:{"background-color":"#fff"}},[a("label",{staticStyle:{textAlign:"center",display:"block",fontSize:"22px",lineHeight:"50px",fontFamily:"'Arial'","font-weight":"normal"}},[e._v("工艺参数信息")]),a("div",{staticClass:"board"},[a("Kanban",{key:1,staticClass:"kanban coreProcess",attrs:{list:e.list_coreProcess,group:e.group,"header-text":"关键工艺参数"}}),a("Kanban",{key:2,staticClass:"kanban importProcess",attrs:{list:e.list_importProcess,group:e.group,"header-text":"重要工艺参数"}}),a("Kanban",{key:3,staticClass:"kanban otherProcess",attrs:{list:e.list_otherProcess,group:e.group,"header-text":"其他工艺参数"}})],1)])],1)],1)])},r=[],i=a("5530"),s=(a("ac1f"),a("841c"),a("d81d"),a("4de4"),a("d3b7"),a("14d9"),a("b0c0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:e.className,style:{height:e.height,width:e.width}})}),o=[],u=(a("a15b"),a("b680"),a("313e")),c=a("ed08"),l={data:function(){return{$_sidebarElm:null,$_resizeHandler:null}},mounted:function(){var e=this;this.$_resizeHandler=Object(c["b"])((function(){e.chart&&e.chart.resize()}),100),this.$_initResizeEvent(),this.$_initSidebarResizeEvent()},beforeDestroy:function(){this.$_destroyResizeEvent(),this.$_destroySidebarResizeEvent()},activated:function(){this.$_initResizeEvent(),this.$_initSidebarResizeEvent()},deactivated:function(){this.$_destroyResizeEvent(),this.$_destroySidebarResizeEvent()},methods:{$_initResizeEvent:function(){window.addEventListener("resize",this.$_resizeHandler)},$_destroyResizeEvent:function(){window.removeEventListener("resize",this.$_resizeHandler)},$_sidebarResizeHandler:function(e){"width"===e.propertyName&&this.$_resizeHandler()},$_initSidebarResizeEvent:function(){this.$_sidebarElm=document.getElementsByClassName("sidebar-container")[0],this.$_sidebarElm&&this.$_sidebarElm.addEventListener("transitionend",this.$_sidebarResizeHandler)},$_destroySidebarResizeEvent:function(){this.$_sidebarElm&&this.$_sidebarElm.removeEventListener("transitionend",this.$_sidebarResizeHandler)}}};a("817d");var d={mixins:[l],props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"600px"},data:{type:Array,default:function(){return[{value:320,name:"报警号-1",message:"NO.1:buffe下压报警！"},{value:240,name:"报警号-2",message:"NO.2:buffe下压报警！"},{value:149,name:"报警号-3",message:"NO.3:buffe下压报警！"},{value:100,name:"报警号-4",message:"NO.4:buffe下压报警！"},{value:59,name:"报警号-5",message:"NO.5:buffe下压报警！"}]}},config:{type:Object,default:function(){return{title:"饼形图",graphicPos:370}}}},data:function(){return{chart:null}},watch:{data:{handler:function(e){this.chartSetOption()},deep:!0}},mounted:function(){var e=this;this.$nextTick((function(){e.initChart()}))},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart:function(){this.chart=u["init"](this.$el,"macarons"),this.chartSetOption()},chartSetOption:function(){var e=this;this.chart.setOption({title:{text:this.config.title,x:"center",top:10,textStyle:{fontWeight:"normal",color:"black",fontSize:"22",fontFamily:"Arial"}},graphic:{type:"text",left:"60%",top:this.config.graphicPos,style:{text:"{normal|--报警详细信息--}\n"+this.data.map((function(e){return e.message})).join("\n"),textAlign:"left",fill:"#333",fontSize:14,lineHeight:20,rich:{normal:{fontSize:16,fontWeight:700}}}},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},restore:{show:!1},saveAsImage:{show:!0}}},legend:{orient:"vertical",left:"60%",top:90,bottom:20,textStyle:{fontSize:16,lineHeight:18,fontFamily:"Arial",align:"center",rich:{normal:{fontSize:16,width:100},red:{fontSize:16,align:"center",color:"#EF3E5A",width:30},green:{fontSize:16,align:"center",color:"#00EE00",width:70}}},formatter:function(t){for(var a=e.data,n=0,r=0,i=0,s=0,o=a.length;s<o;s++)n+=a[s].value,a[s].name===t&&(r=a[s].value);return i=0===n?0:(r/n*100).toFixed(2),"{normal|"+t+"}共[{red|"+r+"}]次{green|"+i+"%}"}},series:[{name:"报警信息",type:"pie",roseType:"area",radius:[50,150],center:["30%","50%"],data:this.data,animationEasing:"cubicInOut",animationDuration:2600,itemStyle:{borderRadius:9}}]})}}},p=d,m=a("2877"),h=Object(m["a"])(p,s,o,!1,null,null,null),f=h.exports,g=a("7cb6"),b=a("bfea"),v=a("71dc"),y=a("b4af");function S(e){return Object(y["a"])({url:"/api/v1/process",method:"get",params:e})}var _=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"board-column"},[a("div",{staticClass:"board-column-header"},[e._v(" "+e._s(e.headerText)+" ")]),a("draggable",e._b({staticClass:"board-column-content",attrs:{list:e.list,"set-data":e.setData}},"draggable",e.$attrs,!1),e._l(e.list,(function(t){return a("div",{key:t.id,staticClass:"board-item"},[e._v(" "+e._s(t.ParName)+": "+e._s(t.ParValue)+" | "+e._s(t.Description)+" ")])})),0)],1)},k=[],q=a("1980"),x=a.n(q),w={name:"DragKanbanDemo",components:{draggable:x.a},props:{headerText:{type:String,default:"Header"},options:{type:Object,default:function(){return{}}},list:{type:Array,default:function(){return[]}}},methods:{setData:function(e){e.setData("Text","")}}},E=w,O=(a("09e4"),Object(m["a"])(E,_,k,!1,null,"15beecf0",null)),D=O.exports,T={name:"EqpStatus",components:{AlarmPieChart:f,Kanban:D},data:function(){return{AlarmList:[],pieConfig:{title:"设备报警",graphicPos:""},pieSrcData:[{name:"报警号-无",value:0,message:""}],periodModeArray:[{label:"每小时",value:"everyHour"},{label:"每日",value:"everyDay"},{label:"每月",value:"everyMonth"}],search:{periodMode:"everyHour",selectedEqpName:void 0,startTime:new Date((new Date).toLocaleDateString()+" 00:00:00"),endTime:new Date((new Date).toLocaleDateString()+" 24:00:00")},equipmentList:null,DateType:"datetime",equipStatusMode:{run:1,alarm:2,standby:3,stop:4},equipStatus:1,startPickerOptions:{shortcuts:[{text:"昨天",onClick:function(e){var t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}},{text:"一周前",onClick:function(e){var t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}},{text:"一个月前",onClick:function(e){var t=new Date;t.setTime(t.getTime()-2592e6),e.$emit("pick",t)}},{text:"六个月前",onClick:function(e){var t=new Date;t.setTime(t.getTime()-15552e6),e.$emit("pick",t)}}]},endPickerOptions:{shortcuts:[{text:"今天",onClick:function(e){var t=new Date;t.setTime(t.getTime()),e.$emit("pick",t)}}]},group:"mission",list_coreProcess:[],list_importProcess:[],list_otherProcess:[]}},created:function(){null==this.equipmentList&&this.getTotalList(),this.pieConfig.graphicPos=130},mounted:function(){},beforeDestroy:function(){},methods:{getAlarmInfo:function(){var e=this;if(this.search.selectedEqpName){var t={};t.selectedEqpName=this.search.selectedEqpName,t.startTime=this.search.startTime,t.endTime=this.search.endTime,Object(b["a"])(t).then((function(t){var a=t.data;e.AlarmList=a.map((function(e){return{DateTime:new Date(e.DateTime).toLocaleDateString(),Id:e.Id,Duration:e.Duration,Message:e.Message}}))}))}},formateTime:function(e){var t=e.getFullYear()+"-",a=(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-",n=(e.getDate()<10?"0"+e.getDate():e.getDate())+" ",r=(e.getHours()<10?"0"+e.getHours():e.getHours())+":",i=(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":",s=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds();return t+a+n+r+i+s},getEquipStatus:function(){var e=this;Object(v["j"])().then((function(t){var a=t.data.filter((function(t){return e.search.selectedEqpName===t[0]}))[0][1];switch(e.search.selectedEqpName.substring(0,3).toUpperCase()){case"PRI":case"DRY":e.equipStatus="0"===a||"1"===a||"3"===a||"4"===a?e.equipStatusMode.run:"2"===a?e.equipStatusMode.stop:"6"===a?e.equipStatusMode.alarm:"5"===a?e.equipStatusMode.standby:"--";break;case"BUF":e.equipStatus="0"===a||"1"===a?e.equipStatusMode.run:"3"===a?e.equipStatusMode.stop:"4"===a?e.equipStatusMode.alarm:"2"===a?e.equipStatusMode.standby:"--";break;default:e.equipStatus="1"===a?e.equipStatusMode.run:"3"===a?e.equipStatusMode.stop:"4"===a?e.equipStatusMode.alarm:"2"===a?e.equipStatusMode.standby:"--";break}}))},getTotalList:function(){var e=this;Object(g["c"])().then((function(t){e.equipmentList=t.data.items,e.search.selectedEqpName=e.equipmentList[0].EqpName,e.handleDraw()}))},getProcess:function(){var e=this,t={eqpName:this.search.selectedEqpName};S(t).then((function(t){e.list_coreProcess=[],e.list_importProcess=[],e.list_otherProcess=[],t.data.items.map((function(t){switch(t.Level){case 0:e.list_coreProcess.push(t);break;case 1:e.list_importProcess.push(t);break;case 2:e.list_otherProcess.push(t);break;default:break}}))}))},handleDraw:function(){var e=this;if(this.search.selectedEqpName)if(null!=this.search.startTime&&null!=this.search.endTime)if(this.search.startTime>this.search.endTime)this.$notify.error({title:"错误",message:"时间设置错误! 开始时间不能大于结束时间"});else{var t=Object(i["a"])({},this.search);delete t.periodMode,Object(b["c"])(t).then((function(t){var a=t.data;e.pieSrcData=a.map((function(e){var t=e.message;return""!==t&&-1===t.indexOf("NO.")&&(t="NO."+e.name+":"+e.message),{name:"报警号-"+e.name,value:e.value,message:t}})),e.pieConfig.graphicPos=30*t.data.length+90+10})),this.getAlarmInfo(),this.getEquipStatus(),this.getProcess()}else this.$notify.error({title:"错误",message:"开始时间和结束时间为空！"});else this.$notify.error({title:"错误",message:"未获取到设备名称，网络故障! 请重新刷新页面！"})},setRowClass:function(e){var t=e.row,a=e.rowIndex;if(0===a&&null!=t)return"row-red"}}},$=T,j=(a("c1b8"),Object(m["a"])($,n,r,!1,null,"17c83e06",null));t["default"]=j.exports},bfea:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return s})),a.d(t,"e",(function(){return o})),a.d(t,"b",(function(){return u})),a.d(t,"j",(function(){return c})),a.d(t,"f",(function(){return l})),a.d(t,"g",(function(){return d})),a.d(t,"h",(function(){return p})),a.d(t,"i",(function(){return m}));var n=a("b4af");function r(e){return Object(n["a"])({url:"/api/v1/equipments/alarms/groups",method:"get",params:e})}function i(e){return Object(n["a"])({url:"/api/v1/equipments/alarms",method:"get",params:e})}function s(e){return Object(n["a"])({url:"/api/v1/equipments/alarms/Ids",method:"get",params:e})}function o(e){return Object(n["a"])({url:"/api/v1/equipments/alarms/sum",method:"get",params:e})}function u(e){return Object(n["a"])({url:"/api/v1/equipments/alarms/eqp-groups",method:"get",params:e})}function c(e){return Object(n["a"])({url:"/api/v1/equipments/alarms/today/num",method:"get",params:e})}function l(){return Object(n["a"])({url:"/api/v1/equipments/alarms/72hours-total",method:"get"})}function d(){return Object(n["a"])({url:"/api/v1/equipments/alarms/72hours-broken-rate",method:"get"})}function p(){return Object(n["a"])({url:"/api/v1/equipments/alarms/72hours-pass-rate",method:"get"})}function m(){return Object(n["a"])({url:"/api/v1/equipments/alarms/latest",method:"get"})}},c1b8:function(e,t,a){"use strict";a("7c36")}}]);