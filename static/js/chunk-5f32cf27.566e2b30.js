(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5f32cf27"],{"07ac":function(e,t,a){var i=a("23e7"),l=a("6f53").values;i({target:"Object",stat:!0},{values:function(e){return l(e)}})},"372d":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"search-container filter-container"},[a("label",{staticClass:"labelstyle"},[e._v("数据库部署：")]),a("el-button",{attrs:{loading:e.initialDBLoading,type:"primary",icon:"el-icon-circle-check"},on:{click:e.handleInitialDB}},[e._v(" "+e._s(e.$t("table.initialDB"))+" ")]),a("label",{staticClass:"labelstyle",staticStyle:{"margin-left":"10px"}},[e._v("硅片流入流出线别：")]),a("el-select",{staticStyle:{width:"300px"},attrs:{filterable:"",multiple:"","collapse-tags":"",placeholder:"请选择统计的线别"},model:{value:e.selectedWorkLine,callback:function(t){e.selectedWorkLine=t},expression:"selectedWorkLine"}},e._l(e.workLineList,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),1),a("br"),a("label",{staticClass:"labelstyle"},[e._v("配置信息")]),a("el-tooltip",{attrs:{content:"输入破片ID，多个ID，用空格分割",placement:"top",effect:"light"}},[a("el-input",{staticStyle:{width:"200px","margin-right":"10px"},attrs:{placeholder:"多个ID，用空格分割",clearable:""},model:{value:e.brokenAlarmId,callback:function(t){e.brokenAlarmId=t},expression:"brokenAlarmId"}})],1),a("el-tooltip",{attrs:{content:"输入异常片ID，多个ID，用空格分割",placement:"top",effect:"light"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"多个ID，用空格分割",clearable:""},model:{value:e.rejectAlarmId,callback:function(t){e.rejectAlarmId=t},expression:"rejectAlarmId"}})],1),a("el-tooltip",{attrs:{content:"输入丢片ID，多个ID，用空格分割",placement:"top",effect:"light"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"多个ID，用空格分割",clearable:""},model:{value:e.dropAlarmId,callback:function(t){e.dropAlarmId=t},expression:"dropAlarmId"}})],1),a("el-checkbox",{staticStyle:{"margin-left":"10px"},model:{value:e.isOldSilkScreenLine,callback:function(t){e.isOldSilkScreenLine=t},expression:"isOldSilkScreenLine"}},[e._v("老版本丝网整线")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.configSettingInfo}},[e._v(" 写入 ")]),a("br"),a("label",{staticClass:"labelstyle"},[e._v("数据库表信息查询：")]),a("el-select",{staticStyle:{width:"250px"},attrs:{placeholder:"请选择表占用空间大小的界限值，标红显示"},model:{value:e.dataSize,callback:function(t){e.dataSize=t},expression:"dataSize"}},e._l(e.dataSizeOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleGetDBTablesInfo}},[e._v(" "+e._s(e.$t("table.getDBTables"))+" ")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-refresh-right"},on:{click:e.flushDBTablesInfo}},[e._v(" "+e._s(e.$t("table.flushDBTables"))+" ")]),a("br"),a("label",{staticClass:"labelstyle"},[e._v("数据库表中数据的保留时间：")]),a("el-select",{staticStyle:{width:"250px"},attrs:{placeholder:"请选择表中记录过期时间，每天自动删除"},model:{value:e.expirationTime,callback:function(t){e.expirationTime=t},expression:"expirationTime"}},e._l(e.timeOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1),a("el-switch",{staticStyle:{"margin-left":"10px"},attrs:{"active-text":"启用定时清理数据任务","active-color":"#13ce66"},on:{change:e.timerHandleSwitch},model:{value:e.dbDeleteOldDataEnable,callback:function(t){e.dbDeleteOldDataEnable=t},expression:"dbDeleteOldDataEnable"}}),a("el-switch",{staticStyle:{"margin-left":"10px"},attrs:{"active-text":"时间同步","active-color":"#13ce66"},on:{change:e.timeSyncSwitch},model:{value:e.timeSync,callback:function(t){e.timeSync=t},expression:"timeSync"}}),a("br"),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%","font-size":"15px"},attrs:{"element-loading-text":"数据正在加载中，请等候...",height:"600",data:e.showList,border:"",fit:"","highlight-current-row":"","row-style":{height:"20px"},"header-cell-style":{textAlign:"center",height:"20px"},size:"mini","cell-style":{padding:"0px"},"row-class-name":e.setRowClass}},[a("el-table-column",{key:"1",attrs:{label:"数据库名称",prop:"DatabaseName","min-width":"28%",align:"center",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.DatabaseName))])]}}])}),a("el-table-column",{key:"2",attrs:{label:"表名称",prop:"TableName","min-width":"28%",align:"center",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-tooltip",{attrs:{content:"点击删除对应表中数据",placement:"top",effect:"light","hide-after":2500,"open-delay":500}},[a("el-tag",{staticClass:"link-type",on:{click:function(t){return e.handleTable(i)}}},[e._v(e._s(i.TableName))])],1)]}}])}),a("el-table-column",{key:"3",attrs:{label:"占用空间(M)",prop:"TableSize","min-width":"28%",align:"center",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.TableSize))])]}}])}),a("el-table-column",{key:"4",attrs:{label:"记录总数(条)",prop:"RowsCount","min-width":"28%",align:"center",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(i.RowsCount))])]}}])}),a("el-table-column",{key:"5",attrs:{label:"记录初始日期",prop:"MinDateTime","min-width":"28%",align:"center",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(null==i.MinDateTime?"--":e.$moment(i.MinDateTime).format("YYYY-MM-DD HH:mm:ss")))])]}}])}),a("el-table-column",{key:"6",attrs:{label:"记录最新日期",prop:"MaxDateTime","min-width":"28%",align:"center",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("span",[e._v(e._s(null==i.MaxDateTime?"--":e.$moment(i.MaxDateTime).format("YYYY-MM-DD HH:mm:ss")))])]}}])})],1),a("el-dialog",{staticStyle:{"min-width":"500px"},attrs:{title:"删除表数据",visible:e.dialogFormVisible,width:"40%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"dataForm",staticStyle:{width:"70%","margin-left":"50px"},attrs:{model:e.temp,"label-position":"left","label-width":"85px"}},[a("el-form-item",{attrs:{label:"数据库名称",prop:"DatabaseName"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.temp.DatabaseName,callback:function(t){e.$set(e.temp,"DatabaseName",t)},expression:"temp.DatabaseName"}})],1),a("el-form-item",{attrs:{label:"表名称",prop:"TableName"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.temp.TableName,callback:function(t){e.$set(e.temp,"TableName",t)},expression:"temp.TableName"}})],1),a("el-form-item",{attrs:{label:"开始时间",prop:"Workline"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"请选择"},model:{value:e.temp.StartTime,callback:function(t){e.$set(e.temp,"StartTime",t)},expression:"temp.StartTime"}})],1),a("el-form-item",{attrs:{label:"结束时间",prop:"DateTime"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"请选择"},model:{value:e.temp.EndTime,callback:function(t){e.$set(e.temp,"EndTime",t)},expression:"temp.EndTime"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("label",{staticStyle:{"margin-right":"100px"}},[e._v(e._s(e.handleProcessTip))]),a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(" 取消 ")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.deleteData()}}},[e._v(" 删除 ")])],1)],1),a("el-dialog",{attrs:{visible:e.timeSyncDialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.timeSyncDialogVisible=t}}},[a("div",{staticStyle:{"vertical-align":"middle"},attrs:{slot:"title"},slot:"title"},[a("svg-icon",{staticStyle:{width:"40px",height:"40px","vertical-align":"middle"},attrs:{"icon-class":"notice"}}),a("span",{staticStyle:{"margin-left":"10px"}},[e._v("注意")])],1),a("span",[e._v("正在时间同步过程中，勿关闭此页面，请耐心等待...")])])],1)])},l=[],n=(a("d3b7"),a("159b"),a("14d9"),a("b64b"),a("07ac"),a("a15b"),a("71dc")),o=a("7cb6"),r=a("5c96"),s=new WebSocket("ws://127.0.0.1:3000");s.onopen=function(e){console.log("WebSocket服务器连接成功！")},s.onclose=function(e){console.log("WebSocket服务器关闭")},s.onerror=function(){console.log("WebSocket服务器连接失败！")},s.onmessage=function(e){console.log(e.data);var t=e.data.split("|");if(t.length>=3){var a=t[0],i=t[1],l=t[2],n=t[3];switch(a){case"Web":switch(i){case"InitDB":"200"===l?Object(r["Notification"])({title:n,message:"执行成功",type:"success",duration:5e3}):Object(r["Notification"])({title:n,message:"执行失败",type:"error",duration:1e4});break;default:Object(r["Notification"])({title:"未定义event："+i,message:n,type:"error",duration:1e4});break}break;default:Object(r["Notification"])({title:"未定义user："+a,message:n,type:"error",duration:1e4});break}}},s.con;var c,d,m,u=s,b="darkblue-row",p={name:"",components:{},data:function(){return{selectedWorkLine:[],workLineList:[],brokenAlarmId:"",rejectAlarmId:"",dropAlarmId:"",initialDBLoading:!1,listLoading:!0,showList:[],temp:{DatabaseName:null,TableName:null,StartTime:null,EndTime:null},queryTemp:{DatabaseName:null,TableName:null,StartTime:null,EndTime:null},dialogFormVisible:!1,timeSyncDialogVisible:!1,dataSizeOptions:[{label:"标红-大于200M",value:200},{label:"标红-大于500M",value:500},{label:"标红-大于1GM",value:1024},{label:"标红-大于2G",value:2048}],dataSize:500,timeOptions:[{label:"半个月",value:15},{label:"一个月",value:30},{label:"二个月",value:60},{label:"三个月",value:90},{label:"半年",value:182},{label:"一年",value:365},{label:"二年",value:730}],expirationTime:90,dbDeleteOldDataEnable:!1,handleProcessTip:"",isOldSilkScreenLine:!1,timeSync:!1,timeSyncTimer:void 0}},created:function(){this.handleGetDBTablesInfo()},mounted:function(){},methods:{handleInitialDB:function(){var e=this;this.initialDBLoading=!0,u.send("初始化数据库"),Object(n["i"])().then((function(t){e.initialDBLoading=!1,e.$alert(t.data,"初始化数据库")})).catch((function(t){console.log(t),e.initialDBLoading=!1}))},handleGetDBTablesInfo:function(){var e=this;Object(n["o"])().then((function(t){null!=t.data&&(e.dbDeleteOldDataEnable=t.data.dbDeleteOldDataEnable,e.expirationTime=t.data.expirationTime,e.isOldSilkScreenLine=t.data.isOldSilkScreenLine,e.brokenAlarmId=t.data.brokenAlarmId,e.rejectAlarmId=t.data.rejectAlarmId,e.dropAlarmId=t.data.dropAlarmId,e.timeSync=t.data.timeSync,t.data.waferInOutWorkline.split(",").forEach((function(t){e.selectedWorkLine.push(t)})))})),Object(o["c"])().then((function(t){var a=t.data.items;a.forEach((function(t){-1===e.workLineList.indexOf(t.Workline)&&e.workLineList.push(t.Workline)}))})),this.listLoading=!0,Object(n["j"])().then((function(t){e.showList=t.data,e.listLoading=!1})).catch((function(e){console.log(e)})).finally((function(){e.listLoading=!1}))},flushDBTablesInfo:function(){var e=this;Object(n["q"])().then((function(t){e.$notify({title:"表数据刷新成功，请重新点击查询",message:"执行成功",type:"success",duration:3e3})})).catch((function(e){console.log(e)}))},setRowClass:function(e){var t=e.row,a=e.rowIndex,i=parseInt(t.TableSize);return""===t.DatabaseName?i>=this.dataSize?"lightblue-row-red":"lightblue-row-black":(0===a&&(c=m,d=b),c===t.DatabaseName?"lightblue-row"===d?i>=this.dataSize?"lightblue-row-red":"lightblue-row-black":i>=this.dataSize?"darkblue-row-red":"darkblue-row-black":(c=t.DatabaseName,"lightblue-row"===d?(d="darkblue-row",0===a&&(m=t.DatabaseName,b="darkblue-row"),i>=this.dataSize?"darkblue-row-red":"darkblue-row-black"):(0===a&&(m=t.DatabaseName,b="lightblue-row"),d="lightblue-row",i>=this.dataSize?"lightblue-row-red":"lightblue-row-black")))},handleTable:function(e){this.handleProcessTip="",this.temp.DatabaseName=e.DatabaseName,this.temp.TableName=e.TableName,this.temp.StartTime=e.MinDateTime,this.temp.EndTime=e.MaxDateTime,this.dialogFormVisible=!0},handleClose:function(e){this.$confirm("确认关闭？").then((function(t){e()})).catch((function(e){}))},deleteData:function(){var e=this;this.queryTemp=Object.assign({},this.temp),this.queryTemp.StartTime=this.$moment(this.temp.StartTime).format("YYYY-MM-DD HH:mm:ss"),this.queryTemp.EndTime=this.$moment(this.temp.EndTime).format("YYYY-MM-DD HH:mm:ss"),this.$confirm("确认要删除表数据吗？").then((function(t){e.handleProcessTip="正在删除中，请耐心等待......",Object(n["e"])(e.queryTemp).then((function(t){e.handleProcessTip="",t.data?(e.$notify({title:"删除表数据",message:"执行成功",type:"success",duration:3e3}),e.dialogFormVisible=!1):e.$notify({title:"删除表数据",message:"执行失败",type:"error",duration:3e3})}))})).catch((function(e){}))},timerHandleSwitch:function(){var e=this;this.dbDeleteOldDataEnable?this.$confirm("确认需要开启定时清理数据任务吗？").then((function(t){e.configDeleteOldDataTimer()})).catch((function(t){e.dbDeleteOldDataEnable=!1})):this.$confirm("确认需要关闭定时清理数据任务吗？").then((function(t){e.configDeleteOldDataTimer()})).catch((function(t){e.dbDeleteOldDataEnable=!0}))},timeSyncSwitch:function(){var e=this;this.timeSync?this.$confirm("确认需要开始同步设备时间吗？").then((function(t){e.configTimeSync(!0)})).catch((function(t){e.timeSync=!1})):this.$confirm("确认需要结束同步设备时间吗？").then((function(t){e.configTimeSync(!1)})).catch((function(t){e.timeSync=!0}))},configDeleteOldDataTimer:function(){var e=this,t={dbDeleteOldDataEnable:this.dbDeleteOldDataEnable,expirationTime:this.expirationTime};Object(n["d"])(t).then((function(t){if(0===Object.keys(t.data).length)e.$notify({title:"参数未更新",message:"执行成功",type:"success",duration:3e3});else for(var a=function(a){setTimeout((function(){Object.values(t.data)[a]?e.$notify({title:"设置定时清理任务"+Object.keys(t.data)[a],message:"执行成功",type:"success",duration:3e3}):e.$notify({title:"设置定时清理任务"+Object.keys(t.data)[a],message:"执行失败",type:"error",duration:3e3})}),200)},i=0;i<Object.keys(t.data).length;i++)a(i)}))},configTimeSync:function(e){var t=this,a={timeSync:e};Object(n["c"])(a).then((function(a){if(a.data)if(e){t.timeSyncDialogVisible=!0;var i=0;t.timeSyncTimer&&clearInterval(t.timeSyncTimer),t.timeSyncTimer=setInterval((function(){i++,i<120?t.fetchTimeSyncValue():(t.timeSyncDialogVisible=!1,t.$notify({title:"同步超时",message:"同步超时2min",type:"error",duration:3e3}),t.timeSyncTimer&&clearInterval(t.timeSyncTimer))}),1e3)}else t.$notify({title:"时间同步",message:"关闭成功",type:"success",duration:3e3});else t.$notify({title:"时间同步",message:"开启失败",type:"error",duration:3e3})}))},fetchTimeSyncValue:function(){var e=this,t={name:"timeSync"};Object(n["p"])(t).then((function(t){e.timeSync=JSON.parse(t.data.toLowerCase()),"false"===t.data.toLowerCase()&&(e.timeSyncTimer&&clearInterval(e.timeSyncTimer),e.timeSyncDialogVisible=!1,e.$notify({title:"时间同步",message:"同步完成",type:"success",duration:3e3}))}))},configSettingInfo:function(){var e=this,t={isOldSilkScreenLine:this.isOldSilkScreenLine,brokenAlarmId:this.brokenAlarmId,rejectAlarmId:this.rejectAlarmId,dropAlarmId:this.dropAlarmId,waferInOutWorkline:this.selectedWorkLine.join(",")};Object(n["a"])(t).then((function(t){if(0===Object.keys(t.data).length)e.$notify({title:"参数未更新",message:"执行成功",type:"success",duration:3e3});else for(var a=function(a){setTimeout((function(){Object.values(t.data)[a]?e.$notify({title:"修改参数"+Object.keys(t.data)[a],message:"执行成功",type:"success",duration:3e3}):e.$notify({title:"修改参数"+Object.keys(t.data)[a],message:"执行失败",type:"error",duration:3e3})}),200)},i=0;i<Object.keys(t.data).length;i++)a(i)}))}}},f=p,h=(a("b1c2"),a("2877")),y=Object(h["a"])(f,i,l,!1,null,"567cc4a1",null);t["default"]=y.exports},"6f53":function(e,t,a){var i=a("83ab"),l=a("e330"),n=a("df75"),o=a("fc6a"),r=a("d1e7").f,s=l(r),c=l([].push),d=function(e){return function(t){var a,l=o(t),r=n(l),d=r.length,m=0,u=[];while(d>m)a=r[m++],i&&!s(l,a)||c(u,e?[a,l[a]]:l[a]);return u}};e.exports={entries:d(!0),values:d(!1)}},"7cb6":function(e,t,a){"use strict";a.d(t,"d",(function(){return l})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return o})),a.d(t,"e",(function(){return r})),a.d(t,"b",(function(){return s}));var i=a("b4af");function l(e){return Object(i["a"])({url:"/api/v1/equipments/page",method:"get",params:e})}function n(){return Object(i["a"])({url:"/api/v1/equipments",method:"get"})}function o(e){return Object(i["a"])({url:"/api/v1/equipments",method:"post",data:e})}function r(e){return Object(i["a"])({url:"/api/v1/equipments/"+e.Id,method:"put",data:e})}function s(e){return Object(i["a"])({url:"/api/v1/equipments/"+e.Id,method:"Delete",data:e})}},b1c2:function(e,t,a){"use strict";a("fcb9")},fcb9:function(e,t,a){}}]);