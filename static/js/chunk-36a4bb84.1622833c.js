(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-36a4bb84"],{3467:function(t,e,i){},6158:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("div",{staticStyle:{"background-color":"#EBEBEB"}},[i("el-button",{staticStyle:{margin:"8px"},attrs:{type:"primary",disabled:t.saveDisable},on:{click:t.saveConfig}},[t._v("保存")]),i("el-button",{staticStyle:{margin:"8px"},attrs:{type:"primary"},on:{click:t.showSetTimDialog}},[t._v("定时发送")]),i("el-button",{staticStyle:{margin:"8px"},attrs:{type:"primary"},on:{click:t.sendMailNow}},[t._v("发送")])],1),i("div",{staticStyle:{"background-color":"#F5F5F5"}},[i("el-form",{ref:"mail",staticStyle:{"font-size":"12px",width:"70%"},attrs:{model:t.mail,rules:t.rules,"label-width":"80px",size:"small"}},[i("el-form-item",{attrs:{label:"收件人",prop:"toAddress"}},[i("el-input",{staticClass:"input",model:{value:t.mail.toAddress,callback:function(e){t.$set(t.mail,"toAddress",e)},expression:"mail.toAddress"}})],1),i("el-form-item",{attrs:{label:"抄送人",prop:"ccAddress"}},[i("el-input",{staticClass:"input",model:{value:t.mail.ccAddress,callback:function(e){t.$set(t.mail,"ccAddress",e)},expression:"mail.ccAddress"}})],1),i("el-form-item",{attrs:{label:"主题",prop:"subject"}},[i("el-input",{staticClass:"input",model:{value:t.mail.subject,callback:function(e){t.$set(t.mail,"subject",e)},expression:"mail.subject"}})],1),i("el-form-item",{attrs:{label:"正文",prop:"content"}},[i("tinymce",{attrs:{height:700},model:{value:t.mail.content,callback:function(e){t.$set(t.mail,"content",e)},expression:"mail.content"}})],1)],1)],1),i("el-dialog",{attrs:{title:"定时发送",visible:t.setTimedialogVisible,width:"35%","custom-class":"el-dialog-class"},on:{"update:visible":function(e){t.setTimedialogVisible=e}}},[i("el-form",{staticStyle:{"font-size":"12px","text-align":"left"},attrs:{"label-width":"40%",size:"small"}},[i("el-form-item",{attrs:{label:"定时开关："}},[i("el-switch",{staticStyle:{"margin-left":"30px"},attrs:{"active-text":"开启","inactive-text":"关闭","active-color":"#13ce66"},model:{value:t.mail.autoSendMailReport,callback:function(e){t.$set(t.mail,"autoSendMailReport",e)},expression:"mail.autoSendMailReport"}})],1),i("el-form-item",{attrs:{label:"定时发送时间："}},[i("el-date-picker",{staticStyle:{"margin-left":"30px"},attrs:{type:"datetime",clearable:!1,placeholder:"选择时间",disabled:!t.mail.autoSendMailReport,"picker-options":t.pickerOptions},on:{change:t.fliterDate},model:{value:t.mail.setTime,callback:function(e){t.$set(t.mail,"setTime",e)},expression:"mail.setTime"}})],1),i("el-form-item",{attrs:{label:"选择发送方式："}},[i("el-radio-group",{staticStyle:{"margin-left":"30px"},attrs:{size:"mini",disabled:!t.mail.autoSendMailReport},model:{value:t.mail.triggerMode,callback:function(e){t.$set(t.mail,"triggerMode",e)},expression:"mail.triggerMode"}},[i("el-radio-button",{attrs:{label:"everyday"}},[t._v("每日")]),i("el-radio-button",{attrs:{label:"once"}},[t._v("仅一次")])],1)],1)],1),i("div",[t.mail.autoSendMailReport?i("span",{staticStyle:{color:"#727d95"}},[t._v("本邮件将在"),i("strong",{staticStyle:{color:"#000"}},[t._v(t._s(t._f("getDateExecutionString")(t.mail.setTime)))]),t._v("投递到对方邮箱。")]):i("span",{staticStyle:{color:"#727d95"}},[i("strong",{staticStyle:{color:"#000"}},[t._v("无定时任务。")])])]),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.setTimedialogVisible=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.setTimeToSendMail}},[t._v("确 定")])],1)],1)],1)},a=[],r=(i("99af"),i("d9e2"),i("ac1f"),i("00b4"),i("e9c4"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tinymce-container",class:{fullscreen:t.fullscreen},style:{width:t.containerWidth}},[i("textarea",{staticClass:"tinymce-textarea",attrs:{id:t.tinymceId}}),t._v(" "),i("div",{staticClass:"editor-custom-btn-container"},[i("editorImage",{staticClass:"editor-upload-btn",attrs:{color:"#1890ff"},on:{successCBK:t.imageSuccessCBK}})],1)])}),o=[],s=(i("b680"),i("a9e3"),i("d3b7"),i("159b"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"upload-container"},[i("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-upload",{staticClass:"editor-slide-upload",attrs:{multiple:!0,"file-list":t.fileList,"show-file-list":!0,"on-remove":t.handleRemove,"on-success":t.handleSuccess,"before-upload":t.beforeUpload,action:"https://httpbin.org/post","list-type":"picture-card"}},[i("el-button",{attrs:{size:"small",type:"primary"}},[t._v(" Click upload ")])],1),i("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v(" Cancel ")]),i("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v(" Confirm ")])],1)],1)}),l=[],c=(i("b64b"),i("d81d"),i("3ca3"),i("ddb0"),i("2b3d"),i("9861"),{name:"EditorSlideUpload",props:{color:{type:String,default:"#1890ff"}},data:function(){return{dialogVisible:!1,listObj:{},fileList:[]}},methods:{checkAllSuccess:function(){var t=this;return Object.keys(this.listObj).every((function(e){return t.listObj[e].hasSuccess}))},handleSubmit:function(){var t=this,e=Object.keys(this.listObj).map((function(e){return t.listObj[e]}));this.checkAllSuccess()?(this.$emit("successCBK",e),this.listObj={},this.fileList=[],this.dialogVisible=!1):this.$message("Please wait for all images to be uploaded successfully. If there is a network problem, please refresh the page and upload again!")},handleSuccess:function(t,e){for(var i=e.uid,n=Object.keys(this.listObj),a=0,r=n.length;a<r;a++)if(this.listObj[n[a]].uid===i)return this.listObj[n[a]].url=t.files.file,void(this.listObj[n[a]].hasSuccess=!0)},handleRemove:function(t){for(var e=t.uid,i=Object.keys(this.listObj),n=0,a=i.length;n<a;n++)if(this.listObj[i[n]].uid===e)return void delete this.listObj[i[n]]},beforeUpload:function(t){var e=this,i=window.URL||window.webkitURL,n=t.uid;return this.listObj[n]={},new Promise((function(a,r){var o=new Image;o.src=i.createObjectURL(t),o.onload=function(){e.listObj[n]={hasSuccess:!1,uid:t.uid,width:this.width,height:this.height}},a(!0)}))}}}),u=c,d=(i("d905"),i("2877")),m=Object(d["a"])(u,s,l,!1,null,"119050cc",null),f=m.exports,h=["advlist anchor autolink autosave code codesample colorpicker colorpicker contextmenu directionality emoticons fullscreen hr image imagetools insertdatetime link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount"],p=h,g=["searchreplace bold italic underline strikethrough alignleft aligncenter alignright outdent indent  blockquote undo redo removeformat subscript superscript code codesample","hr bullist numlist link image charmap preview anchor pagebreak insertdatetime media table emoticons forecolor backcolor fullscreen"],b=g,v=i("b85c"),y=(i("14d9"),[]);function w(){return window.tinymce}var k=function(t,e){var i=document.getElementById(t),n=e||function(){};if(!i){var a=document.createElement("script");a.src=t,a.id=t,document.body.appendChild(a),y.push(n);var r="onload"in a?o:s;r(a)}function o(e){e.onload=function(){this.onerror=this.onload=null;var t,i=Object(v["a"])(y);try{for(i.s();!(t=i.n()).done;){var n=t.value;n(null,e)}}catch(a){i.e(a)}finally{i.f()}y=null},e.onerror=function(){this.onerror=this.onload=null,n(new Error("Failed to load "+t),e)}}function s(t){t.onreadystatechange=function(){if("complete"===this.readyState||"loaded"===this.readyState){this.onreadystatechange=null;var e,i=Object(v["a"])(y);try{for(i.s();!(e=i.n()).done;){var n=e.value;n(null,t)}}catch(a){i.e(a)}finally{i.f()}y=null}}}i&&n&&(w()?n(null,i):y.push(n))},S=k,_="https://cdn.jsdelivr.net/npm/tinymce-all-in-one@4.9.3/tinymce.min.js",j={name:"Tinymce",components:{editorImage:f},props:{id:{type:String,default:function(){return"vue-tinymce-"+ +new Date+(1e3*Math.random()).toFixed(0)}},value:{type:String,default:""},toolbar:{type:Array,required:!1,default:function(){return[]}},menubar:{type:String,default:"file edit insert view format table"},height:{type:[Number,String],required:!1,default:360},width:{type:[Number,String],required:!1,default:"auto"}},data:function(){return{hasChange:!1,hasInit:!1,tinymceId:this.id,fullscreen:!1,languageTypeList:{en:"en",zh:"zh_CN",es:"es_MX",ja:"ja"}}},computed:{language:function(){return this.languageTypeList[this.$store.getters.language]},containerWidth:function(){var t=this.width;return/^[\d]+(\.[\d]+)?$/.test(t)?"".concat(t,"px"):t}},watch:{value:function(t){var e=this;!this.hasChange&&this.hasInit&&this.$nextTick((function(){return window.tinymce.get(e.tinymceId).setContent(t||"")}))},language:function(){var t=this;this.destroyTinymce(),this.$nextTick((function(){return t.initTinymce()}))}},mounted:function(){this.init()},activated:function(){window.tinymce&&this.initTinymce()},deactivated:function(){this.destroyTinymce()},destroyed:function(){this.destroyTinymce()},methods:{init:function(){var t=this;S(_,(function(e){e?t.$message.error(e.message):t.initTinymce()}))},initTinymce:function(){var t=this,e=this;window.tinymce.init({language:this.language,selector:"#".concat(this.tinymceId),height:this.height,body_class:"panel-body ",object_resizing:!1,toolbar:this.toolbar.length>0?this.toolbar:b,menubar:this.menubar,plugins:p,end_container_on_empty_block:!0,powerpaste_word_import:"clean",code_dialog_height:450,code_dialog_width:1e3,advlist_bullet_styles:"square",advlist_number_styles:"default",imagetools_cors_hosts:["www.tinymce.com","codepen.io"],default_link_target:"_blank",link_title:!1,nonbreaking_force_tab:!0,init_instance_callback:function(i){e.value&&i.setContent(e.value),e.hasInit=!0,i.on("NodeChange Change KeyUp SetContent",(function(){t.hasChange=!0,t.$emit("input",i.getContent())}))},setup:function(t){t.on("FullscreenStateChanged",(function(t){e.fullscreen=t.state}))},convert_urls:!1})},destroyTinymce:function(){var t=window.tinymce.get(this.tinymceId);this.fullscreen&&t.execCommand("mceFullScreen"),t&&t.destroy()},setContent:function(t){window.tinymce.get(this.tinymceId).setContent(t)},getContent:function(){window.tinymce.get(this.tinymceId).getContent()},imageSuccessCBK:function(t){var e=this;t.forEach((function(t){return window.tinymce.get(e.tinymceId).insertContent('<img class="wscnph" src="'.concat(t.url,'" >'))}))}}},O=j,C=(i("77c8"),Object(d["a"])(O,r,o,!1,null,"1b138af3",null)),$=C.exports,T=i("b4af");function x(t){return Object(T["a"])({url:"api/v1/reportInfo/mailbox/info",method:"put",data:t})}function M(){return Object(T["a"])({url:"api/v1/reportInfo/mailbox/once",method:"get"})}function E(){return Object(T["a"])({url:"api/v1/reportInfo/mailbox/timer",method:"get"})}var I,A=i("71dc"),D={name:"MailReport",components:{Tinymce:$},filters:{getDateExecutionString:function(t){var e=I.$moment(t),i=I.$moment().startOf("day"),n=I.$moment().add(1,"day").startOf("day"),a=I.$moment().add(2,"days").startOf("day"),r=I.$moment().add(1,"week").startOf("week"),o=I.$moment().add(2,"week").startOf("week"),s="AM"===e.format("A")?"上午":"下午";if("once"===I.mail.triggerMode){if(e.isSame(i,"day"))return"今天 ".concat(s).concat(e.format("HH:mm"));if(e.isSame(n,"day"))return"明天 ".concat(s).concat(e.format("HH:mm"));if(e.isSame(a,"day"))return"后天 ".concat(s).concat(e.format("HH:mm"));if(e.isAfter(i)&&e.isBefore(r)){var l=e.format("ddd");return"本".concat(l," ").concat(s).concat(e.format("HH:mm"))}if(e.isAfter(r)&&e.isBefore(o)){var c=e.format("ddd");return"下".concat(c," ").concat(s).concat(e.format("HH:mm"))}return"".concat(e.format("YYYY年MM月DD日 ")).concat(s).concat(e.format("HH:mm"))}if("everyday"===I.mail.triggerMode)return"每天 ".concat(s).concat(e.format("HH:mm"))}},data:function(){var t=function(t,e,i){var n=/^(\w+|\w+\.\w+)@\w+(\.\w+)+$/,a=/((\w+|\w+\.\w+)@\w+(\.\w+)+;?){2,}/;""===e?i(new Error("请输入收件人地址")):""!==e&&!0===a.test(e)?i(new Error("收件人为一个邮件地址，若要添加多个，增加到抄送人输入框，并地址以;分隔")):""!==e&&!1===n.test(e)?i(new Error("邮件格式错误，请输入正确的邮件地址")):i()};return{startDate:this.$moment().subtract(1,"day"),endDate:this.$moment().add(1,"year"),setTimedialogVisible:!1,saveDisable:!0,mail:{toAddress:void 0,ccAddress:void 0,subject:void 0,setTime:null,triggerMode:null,autoSendMailReport:!1,content:""},pickerOptions:{disabledDate:function(t){return t.getTime()<I.startDate.valueOf()||t.getTime()>I.endDate.valueOf()}},rules:{toAddress:[{required:!0,message:t.Error,validator:t,trigger:"blur"}],subject:[{required:!0,message:"邮件主题是必须的",trigger:"blur"}],content:[{required:!0,message:"模板内容是必须的",trigger:"blur"}]}}},watch:{mail:{handler:function(t){this.saveDisable=!1},deep:!0}},beforeCreate:function(){I=this},created:function(){this.fetchMailConfig()},methods:{fliterDate:function(){this.$moment(this.mail.setTime).isBefore(this.$moment())&&(this.mail.setTime=this.$moment())},printf:function(){console.log(this.content)},setTimeToSendMail:function(){var t=this;if(this.mail.autoSendMailReport&&this.$moment(this.mail.setTime).isBefore(this.$moment()))this.$notify({title:"设置定时任务",message:"设置时间小于当前时间！",type:"error",duration:5e3});else{this.setTimedialogVisible=!1;var e=JSON.stringify(this.mail),i={mailConfig:e};x(i).then((function(e){e.data&&E().then((function(e){console.log(e.data),e.data?t.$notify({title:"设置定时任务",message:"执行成功",type:"success",duration:5e3}):t.$notify({title:"设置定时任务",message:"执行失败",type:"error",duration:5e3})}))}))}},showSetTimDialog:function(){var t=this;this.$refs["mail"].validate((function(e){if(!e)return!1;t.mail.setTime||(t.mail.setTime=t.$moment().add("30","minutes")),t.setTimedialogVisible=!0}))},sendMailNow:function(){var t=this;this.$refs["mail"].validate((function(e){if(!e)return!1;M().then((function(e){e.data?t.$notify({title:"邮件发送",message:"执行成功",type:"success",duration:3e3}):t.$notify({title:"邮件发送",message:"执行失败",type:"error",duration:3e3})}))}))},saveConfig:function(){var t=this;this.$refs["mail"].validate((function(e){if(!e)return!1;var i=JSON.stringify(t.mail),n={mailConfig:i};x(n).then((function(e){e.data?t.$notify({title:"保存模板信息",message:"执行成功",type:"success",duration:3e3}):t.$notify({title:"保存模板信息",message:"执行失败",type:"error",duration:3e3})})),t.saveDisable=!0}))},fetchMailConfig:function(){var t=this,e={name:"mailInfo"};Object(A["o"])(e).then((function(e){e.data&&(t.mail=JSON.parse(e.data))}))}}},q=D,B=(i("7d1e"),Object(d["a"])(q,n,a,!1,null,"2d7a6bee",null));e["default"]=B.exports},"71dc":function(t,e,i){"use strict";i.d(e,"j",(function(){return u})),i.d(e,"h",(function(){return d})),i.d(e,"n",(function(){return m})),i.d(e,"o",(function(){return f})),i.d(e,"b",(function(){return h})),i.d(e,"i",(function(){return p})),i.d(e,"p",(function(){return g})),i.d(e,"c",(function(){return b})),i.d(e,"a",(function(){return v})),i.d(e,"d",(function(){return y})),i.d(e,"m",(function(){return w})),i.d(e,"e",(function(){return k})),i.d(e,"k",(function(){return S})),i.d(e,"l",(function(){return _})),i.d(e,"f",(function(){return j})),i.d(e,"g",(function(){return O}));i("d3b7"),i("d9e2");var n=i("bc3a"),a=i.n(n),r=i("5c96"),o=i("4360"),s=i("5f87"),l=a.a.create({baseURL:"/inter",timeout:3e5});l.interceptors.request.use((function(t){return o["a"].getters.token&&Object(s["a"])()&&(t.headers["Authorization"]="Bearer "+Object(s["a"])()),t}),(function(t){return console.log(t),Promise.reject(t)})),l.interceptors.response.use((function(t){var e=t.data;return 2e4!==e.code?(Object(r["Message"])({message:e.message||"Error",type:"error",duration:5e3}),50008!==e.code&&50012!==e.code&&50014!==e.code||r["MessageBox"].confirm("You have been logged out, you can cancel to stay on this page, or log in again","Confirm logout",{confirmButtonText:"Re-Login",cancelButtonText:"Cancel",type:"warning"}).then((function(){o["a"].dispatch("user/resetToken").then((function(){location.reload()}))})),Promise.reject(new Error(e.message||"Error"))):e}),(function(t){return console.log("err"+t),Object(r["Message"])({message:t.message,type:"error",duration:5e3}),Promise.reject(t)}));var c=l;function u(){return c({url:"api/v1/equipments/status",method:"get"})}function d(){return c({url:"api/v1/database/status",method:"get"})}function m(){return c({url:"api/v1/database/status/settings",method:"get"})}function f(t){return c({url:"api/v1/database/status/settings/name",method:"get",params:t})}function h(t){return c({url:"api/v1/database/status/settings/name",method:"put",data:t})}function p(){return c({url:"api/v1/database/status/tables",method:"get"})}function g(){return c({url:"api/v1/database/status/tables/flush",method:"get"})}function b(t){return c({url:"api/v1/database/status/settings/timer",method:"put",data:t})}function v(t){return c({url:"api/v1/database/status/settings/paras",method:"put",data:t})}function y(t){return c({url:"api/v1/database/status/tables",method:"delete",params:t})}function w(t){return c({url:"api/v1/ip/status",method:"get",params:t})}function k(t){return c({url:"api/v1/equipments/status/activation",method:"get",params:t})}function S(t){return c({url:"api/v1/equipments/status/maintenance/hours",method:"get",params:t})}function _(t){return c({url:"api/v1/equipments/status/maintenance/list",method:"get",params:t})}function j(){return c({url:"/api/v1/equipments/status/72hours-energy",method:"get"})}function O(){return c({url:"/api/v1/equipments/status/72hours-qr-pass-rate",method:"get"})}},"72ba":function(t,e,i){},"77c8":function(t,e,i){"use strict";i("3467")},"7d1e":function(t,e,i){"use strict";i("ded4")},d905:function(t,e,i){"use strict";i("72ba")},ded4:function(t,e,i){}}]);